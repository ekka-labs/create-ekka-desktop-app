# EKKA Desktop App

A TypeScript desktop application with built-in database and queue APIs.

## Quick Start

```bash
npm install
npm start            # Web development (browser)
npm run tauri:dev    # Desktop development (native window)
```

## Development Modes

| Command | Mode | Description |
|---------|------|-------------|
| `npm start` | Web | Opens in browser at localhost:5173 |
| `npm run tauri:dev` | Desktop | Opens as native desktop window |
| `npm run tauri:build` | Build | Creates distributable app bundle |

## Project Structure

```
.
├── src/
│   ├── ekka/           # DO NOT TOUCH - EKKA plumbing
│   │   ├── demo-backend.ts  # In-memory db and queue
│   │   ├── client.ts   # Connection management
│   │   ├── api.ts      # db / queue wrappers
│   │   └── ...
│   ├── demo/           # SAFE TO DELETE - demo code
│   │   └── DemoApp.tsx
│   ├── app/            # YOUR CODE
│   │   └── App.tsx
│   └── main.tsx
├── src-tauri/          # Desktop shell (Tauri)
├── branding/           # App identity
│   ├── app.json        # Name, bundle ID, version
│   └── icon.icns       # macOS app icon
└── package.json
```

## Branding

All app branding is controlled from `branding/`:

- **app.json** - App name, bundle ID, version
- **icon.icns** - macOS app icon

See `BRANDING.md` for details.

## Getting Started

1. **Run the demo** - `npm start` or `npm run tauri:dev`
2. **Delete the demo** - Remove `src/demo/` when you're ready
3. **Build your app** - Edit `src/app/App.tsx`
4. **Update main.tsx** - Switch the import from `DemoApp` to `App`

## Client API

```typescript
import { ekka } from './ekka';

// Initialize (must call first)
await ekka.connect();

// Database
await ekka.db.put('key', value);
const data = await ekka.db.get('key');
await ekka.db.delete('key');

// Queue
const jobId = await ekka.queue.enqueue('job-kind', payload);
const job = await ekka.queue.claim();
await ekka.queue.ack(job);
await ekka.queue.nack(job);
```

## Data Storage

Everything runs in memory:
- Data cleared on page/app refresh
- No persistence between sessions
- Perfect for learning and prototyping

## Security Model

**Your TypeScript code is sandboxed.** It:

- MUST NOT read files
- MUST NOT make direct network calls
- MUST NOT decide config
- MUST NOT do crypto
- MUST NOT persist tokens

## ESLint Guardrails

The ESLint config enforces security rules:

- **Banned imports:** `fs`, `https`, `axios`, `child_process`, `crypto`
- **Banned globals:** `process.env`
- **fetch() restriction:** Only allowed inside `src/ekka/client.ts`

Run `npm run lint` to check for violations.

## Scripts

| Script | Description |
|--------|-------------|
| `npm start` | Web dev server |
| `npm run tauri:dev` | Desktop dev mode |
| `npm run tauri:build` | Build desktop app |
| `npm run build` | Build web assets |
| `npm run lint` | Check ESLint rules |
| `npm run lint:fix` | Auto-fix lint issues |

## Prerequisites (Desktop Mode)

Desktop mode requires Rust. Install via:

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
```

Web mode (`npm start`) works without Rust.

---

*Generated by create-ekka-desktop-app*
